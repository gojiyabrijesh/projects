#include<iostream.h>
#include<dos.h>
#include<conio.h>
#include<stdio.h>
void main()
{
	 char a[16]={'1','2','3','+','4','5','6','-','7','8','9','*','.','0','/','='};
	 double  *cal;                                      //[14]={ 1 , 2 , 3 , NULL, 4 , 5 , 6 , NULL , 7 , 8 , 9 , NULL ,  NULL ,  NULL };
	 char ch,*t,*m,point=NULL;
	 int A=0,h=0,p=25,g=0,i=0,j=0,u=0;
	 double jo=1;
	 double tot=0;
	m[0]=NULL;
	cal[0]=0;
	while(1)
	{
		p=25;
		jo=1;
		for(int tt=0; tt<=u; tt++)
		{
			cal[tt]=0;
		}
		u=0;

		ch=NULL;
		clrscr();

		if(kbhit())
		{
			ch=getch();

		}
		for( g=0; g<h; g++)
		{
			if(g==p)
			{
				printf("\n");
				p+=25;
			}
			if(t[g]=='-'|| t[g]=='+' || t[g]=='*' ||t[g]=='/')
			{
					if(t[g-1]=='-'|| t[g-1]=='+' || t[g-1]=='*' ||t[g-1]=='/')
					{
						t[g-1]=t[g];
						h--;
					}
			}
			if(t[g]=='0')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(0/jo);

				}
				else
				{
					cal[u]=cal[u]*10+0;
				}
			}
			else if(t[g]=='1')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(1/jo);

				}
				else
				{
					cal[u]=cal[u]*10+1;
				}
			}
			else if(t[g]=='2')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(2/jo);

				}
				else
				{
					cal[u]=cal[u]*10+2;
				}
			}
			else if(t[g]=='3')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(3/jo);

				}
				else
				{
						cal[u]=cal[u]*10+3;
				}
			}
			else if(t[g]=='4')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(4/jo);

				}
				else
				{
					cal[u]=cal[u]*10+4;
				}
			}
			else if(t[g]=='5')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(5/jo);

				}
				else
				{
					cal[u]=cal[u]*10+5;
				}
			}
			else if(t[g]=='6')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(6/jo);

				}
				else
				{
					cal[u]=cal[u]*10+6;
				}
			}
			else if(t[g]=='7')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(7/jo);

				}
				else
				{
					cal[u]=cal[u]*10+7;
				}
			}
			else if(t[g]=='8')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(8/jo);

				}
				else
				{
					cal[u]=cal[u]*10+8;
				}
			}
			else if(t[g]=='9')
			{
				if(point=='.')
				{
					  jo=jo*10;
					cal[u]=cal[u]+(9/jo);

				}
				else
				{
					cal[u]=cal[u]*10+9;
				}
			}
			else if(t[g]=='-')
			{

				if(point=='.')
				{
					point=NULL;
				}
				u++;
				m[u]='-';

			}
			else if(t[g]=='+')
			{
				if(point=='.')
				{
					point=NULL;
				}
				u++;
				m[u]='+';

			}
			else if(t[g]=='/')
			{
				if(point=='.')
				{
					point=NULL;
				}
				u++;
				m[u]='/';
			}
			else if(t[g]=='*')
			{
				if(point=='.')
				{
					point=NULL;
				}
				u++;
				m[u]='*';

			}
			else if(t[g]=='=')
			{
				h=0;
			}
			else if(t[g]=='.')
			{
				point='.';
			}
			printf("%c",t[g]);
		}
		tot=0;
		for(int v=0; v<=u; v++)
		{
			if(m[v]=='+')
			{
				tot+=cal[v];
			}
			else if(m[v]=='-')
			{
				tot-=cal[v];
			}
			else if(m[v]=='/')
			{
				tot/=cal[v];
			}
			else if(m[v]=='*')
			{
				tot*=cal[v];
			}
			else if(v==0)
			{

				tot=cal[v];
			}
		}
		printf("\n");
		if(ch=='=')
			printf("\n=  %f\n",tot);
		A=0;
		for( i=1; i<=4; i++)
		{
			printf("-------------------------\n");
			for( j=1; j<=4; j++)
			{
				if(ch==a[A] )
				{
					    if(h==0 &&(ch=='+'|| ch=='-' || ch=='*' ||ch=='/'))
					    {
						   ch= NULL;
					    }
					    else
					    {
						t[h]=ch;
						h++;

					    }
				     textbackground(WHITE);
				     textcolor(BLACK);
				}
				printf("|");
				cprintf("  %c  ",a[A]);
				textbackground(BLACK);
				textcolor(WHITE);
				if(j==4)
				{
				    printf("|");
				}
				A++;
			}
			printf("\n");
			if(i==4)
			{
				 printf("-------------------------");
			}
		}
		if(ch=='=')
			ch=getch();
		delay(50);
		if(ch=='\b' && h!=0)
		{
			h--;
		}
		if(ch=='x')
		{
			break;
		}
	}
  }
